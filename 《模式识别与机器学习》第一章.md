---
title: 《PRML》第一章 读书笔记.1
tags: [机器学习、PRML、模式识别]
categories: 机器学习
---
[TOC]

## 模式识别概述

### 1、模式识别
使用算法自动发现数据中的规律，并利用这些规律实现回归、分类等任务。例如**手写数字识别**（MINIST数据）![](https://ws3.sinaimg.cn/large/006tKfTcgy1fgp3424nf1j30pa0aq75d.jpg)

### 2、模式识别的几个步骤

* 特征工程（数据准备）：
  ①一般同一个算法需要的输入数据都是一致的 
  ②有助于提高计算速度、收敛速度（如归一化）![Fig.2](https://ws3.sinaimg.cn/large/006tKfTcgy1fgp3dfjzrvj30gq05m754.jpg "Fig.2")

* 模型（算法）设计：线性回归、支持向量机（SVM）、神经网络

* 训练与验证：
  1) 将数据按比例（$\eta=0.8$)将数据分为训练集与测试集；
  2) 训练阶段，不断调整参数，以期模型能正确判断
  3) 验证：通过验证模型在新的样本上的正确性一测试其泛化能力；如果训练阶段表现非常好、验证阶段表现太差则成为过拟合。（对过去了如指掌，对未来一无所知。 —Luke）

### 3、三个任务

* 监督学习：从银行卡号识别别所属银行、对应卡产品，再比如手写数字识别、画出图片中的卡边界（Fig.2)

* 非监督学习：[鸡尾酒会问题](http://www.endolith.com/wordpress/2009/11/22/a-simple-fastica-example/)（使用独立成分分析）

* 增强学习：通过反馈评分的方式训练机器人行走、搬东西、玩游戏等

这三个任务所处理的场景各不相同，但其中的一些基本概念、思想是一致的。

### 4、多项式拟合

![](https://ws3.sinaimg.cn/large/006tNc79gy1fgp606utlnj30kq0fc74x.jpg )

+ 数据形式（x, y)

+ 模型（算法）：多项式拟合![](https://ws4.sinaimg.cn/large/006tNc79gy1fgp65s70puj30pa03iaae.jpg)

+ 参数学习：最小化损失函数![](https://ws1.sinaimg.cn/large/006tNc79gy1fgp6bkq09nj30eq04gaa9.jpg)

+ 模式选择：选择合适的M，确定模型![](https://ws4.sinaimg.cn/large/006tNc79gy1fgp6iwhkk4j31640vwgps.jpg)

  *trick: 使用均方根对比不同size的数据下模型的损失函数![](https://ws3.sinaimg.cn/large/006tNc79gy1fgp806gv37j30v40dkq4a.jpg)*

+ 如果把数据增加，对于M=9的模式![](https://ws4.sinaimg.cn/large/006tNc79gy1fgp6we4m86j31720fsq5x.jpg)

  *可以看到，当数据增加时，原本过拟合的模型也可以拟合的比较好，也就是说<u>数据量越大越有利于复杂的模型拟合数据</u>，一般认为数据量应该是参数量的5~10倍。后面将看到，参数数量并不是最合适的表示模型复杂度的参数。*

+ 实际情况是数据量不多，模型复杂容易过拟合。防止过拟合：正则化、贝叶斯方法

  岭回归：![](https://ws2.sinaimg.cn/large/006tNc79gy1fgp7rc3lzfj30jk04a74l.jpg)![](https://ws1.sinaimg.cn/large/006tNc79gy1fgp83bwwnwj30uq0r4mzf.jpg)


  使用正则化以后，对于合适的正则化，复杂的模型也可以较好的拟合数据，并不会出现过拟合。而当正则化项过大时，也会出现欠拟合的情况。

## 概率论

模式识别中的一个关键概念：不确定性。造成不确定性的因素是噪声及有限的数据。结合决策理论，即便有用的信息不完整或者模糊不清，也可以做出相对最优的预测。

### 1、基本概念

![](https://ws4.sinaimg.cn/large/006tNc79gy1fgpdbo5eimj31cs0xgjw1.jpg)

+ 联合概率：$p(X=x_{i},Y=y_{j})=\frac{n_{ij}}{N}$
+ 边缘概率：$p(X=x_{i})=\sum_{j=1}^{2}p(X=x_{i},Y=y_{j})$
+ 条件概率：$p(Y=y_j|X=x_i)=\frac{n_{ij}}{n_i}$

边缘概率的另一种表示：$p(X=x_i)=\frac{n_i}{N}$
所以得到：
$$
p(X=x_i,Y=y_j)=\frac{n_{ij}}{N}
=\frac{n_{ij}}{n_i}·\frac{n_i}{N}
=p(Y=y_j|X=x_i)p(X=x_i)
$$
独立变量：如果两个变量的联合概率可以分解为边缘概率的乘积，那么这两个变量独立。$P(a,b) = p(a)p(b)$

> 思考： 上面图中的X，Y是否独立？

<img src="https://ws3.sinaimg.cn/large/006tNc79gy1fgpfun2ds4j30vu0nmwgo.jpg" style="zoom:40%">

上面这幅图表示两幅图的颜色直方图分布，其中考虑了周期性。各个颜色值所对应的概率分布通过简单的数据统计与总数值相除得出。
$$
p(h)=\frac{n_h}{\sum_{i=0}^{255}n_i}
$$

### 2、 概率密度

对于连续变量，概率一般表示为概率密度$p(x)$,

<img src="https://ws2.sinaimg.cn/large/006tNc79gy1fgpey6ewpdj30ou0iq0tx.jpg" style="zoom:50%">

已知概率密度为$p(x)$, 则x在区间(a,b)范围内的概率为$p(x\in(a,b))=\int_a^bp(x)dx$

概率密度的性质：
$$
p(x) \ge 0
$$
$$
\int_{-\infty}^{\infty}p(x)dx = 1
$$

累积概率函数（cdf）:
$$
P(x)=\int_{-\infty}^{x}p(x)dx
$$

连续变量的边缘概率分布与联合概率分布：

<img src="https://ws1.sinaimg.cn/large/006tNc79gy1fgpguqbif7j30gs05k74n.jpg" style="zoom:50">

### 3、 期望与协方差(以离散变量为例)

期望：$E[f]=\sum_{x}p(x)f(x)$
​	    $E[f]=\frac{1}{N}\sum f(x_n)$

方差：$var[f]=E[(f(x)-E[f(x)])^2]$
​	    $var[f]=E[f^2]-E[f]^2$

协方差: $cov[x,y]=E_{x,y}[\{x-E[x]\}\{y-E[y]\}]$

### 4、 贝叶斯公式

$$
p(x,y)=p(x|y)p(y)=p(y|x)p(x)
$$

$$
\Longrightarrow p(y|x)=\frac{p(x|y)p(y)}{p(x)}
$$

> 我们之前听说，好莱坞影星安吉丽娜朱莉通过《纽约时报》向大家揭露了她惨痛的经历。因携带有BRCA1/2致癌基因，她有87%的机会患上乳腺癌（我们假设5年）。为了防患于未然，她决定切除双乳(确切说是切除双侧乳腺)。美国乳腺癌的发病率为0.236%（每年每1000成年妇女中有2.36个人患上癌症。普通妇女人群5年患癌概率1.18%。
>
> A:普通妇女5年癌症得病；
>
> B：BRCA1/2致癌基因阳性；
>
> P(A):普通妇女人群5年患癌概率1.18%；
>
> P(B｜A):乳腺癌病人中BRCA1/2致癌基因阳性检测率87%；
>
> P(A｜B):有阳性结果的条件下，安吉丽娜朱莉5年内患癌概率；
>
> P(B)：结果为阳性的总可能性=检查阳性中的真阳性+检查阴性中的真阳性。
>
> 通过贝叶斯公式，
>
> P(A｜B)= P(B｜A)×P(A)/ P(B)=87%×1.18%/（87%×1.18%+13%×98.2%）=7.4%。

